<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Example of utilizing ggmap to create a map outlining ">
  <meta name="generator" content="Hugo 0.54.0" />

  <title>Outline a Route on a Map &middot; Will Carcamo</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">WC</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/Wcarcamo3" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/wcarcamo" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/Wcarcamo" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2019. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Outline a Route on a Map</h1>
  <h2>Example of utilizing ggmap to create a map outlining </h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>21 Apr 2019</time>
  </div>

  

  
  
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/google-api">Google API</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/ggmap">ggmap</a>
    
  </div>
  
  

</div>

  
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="/rmarkdown-libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>


<div id="working-with-maps" class="section level1">
<h1>Working with Maps</h1>
<p>If you are interesting in learning about how to use R to work with geospatial data, I would first point you in the direction of reading <a href="https://geocompr.robinlovelace.net/">Geocomputation in R</a>. I previously thought that you had to use special software like ArcGIS in order to make maps but I found it not too difficult using certain R packages to make simple maps quickly. I particularly like the <strong>tmap</strong> package for static maps and <strong>leaflet</strong> for dynamic (interactive maps). However, <strong>tmap</strong> has some integration with leaflet which can allow users to convert their static maps created within the tmap functions into an interactive one.</p>
</div>
<div id="creating-the-map-in-the-about-section" class="section level1">
<h1>Creating the Map in the About Section</h1>
<p>In the about page I included the following map.</p>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-118.24357,-118.24554,-118.24427,-118.24181,-118.24266,-118.25631,-118.28453,-118.29761,-118.30503,-118.3111,-118.31759,-118.32487,-118.3346,-118.33885,-118.34476,-118.3523,-118.35802,-118.36637,-118.37024,-118.37704,-118.3827,-118.38852,-118.4002,-118.4047,-118.40918,-118.41054,-118.40957,-118.41785,-118.43948,-118.45898,-118.4745,-118.49586,-118.50408,-118.50785,-118.51969,-118.52674,-118.53431,-118.54562,-118.55343,-118.56115,-118.56668,-118.57108,-118.58287,-118.58608,-118.59063,-118.60526,-118.61135,-118.61499,-118.61539,-118.61644,-118.6143,-118.61726,-118.62178,-118.62888,-118.63783,-118.6458,-118.65206,-118.67054,-118.67304,-118.67633,-118.6858,-118.69048,-118.696,-118.70342,-118.70977,-118.71151,-118.71091,-118.713,-118.7217,-118.72858,-118.73773,-118.74913,-118.75439,-118.75634,-118.76317,-118.76778,-118.77726,-118.78636,-118.79255,-118.79831,-118.79881,-118.79688,-118.7955,-118.79801,-118.80325,-118.81288,-118.83432,-118.86719,-118.87252,-118.88351,-118.88452,-118.88325,-118.86753,-118.86287,-118.86308,-118.87506,-118.88806,-118.89788,-118.9012,-118.912,-118.92036,-118.92246,-118.92328,-118.92339,-118.92223,-118.92353,-118.93076,-118.93799,-118.95155,-118.95187,-118.95505,-118.97193,-119.01382,-119.06008,-119.20399,-119.24929,-119.27121,-119.32889,-119.42662,-119.53012,-119.57415,-119.60289,-119.64283,-119.65342,-119.67982,-119.70438,-119.77896,-119.81506,-119.84738,-119.95786,-119.98161,-120.00454,-120.03623,-120.08359,-120.10397,-120.12527,-120.19396,-120.24217,-120.27074,-120.28095,-120.3192,-120.42491,-120.45798,-120.48493,-120.51814,-120.61051,-120.64838,-120.69028,-120.77802,-120.80257,-120.82068,-120.85256,-120.87532,-120.88969,-120.89928,-120.91452,-120.93062,-120.97114,-120.99617,-121.02287,-121.04233,-121.07668,-121.10358,-121.11863,-121.13088,-121.14175,-121.15506,-121.16495,-121.17166,-121.18504,-121.20104,-121.22311,-121.25515,-121.31978,-121.33755,-121.34159,-121.34291,-121.34313,-121.34353,-121.34318,-121.34083,-121.32724,-121.30146,-121.29691,-121.28758,-121.27777,-121.27953,-121.29607,-121.29901,-121.3015,-121.31416,-121.32993,-121.33364,-121.33708,-121.34404,-121.36569,-121.37942,-121.38843,-121.39543,-121.39974,-121.4003,-121.39906,-121.39938,-121.40078,-121.4151,-121.44026,-121.44443,-121.45431,-121.46658,-121.47867,-121.48719,-121.49686,-121.49971,-121.50818,-121.51487,-121.51736,-121.5211,-121.52206,-121.5202,-121.51697,-121.51275,-121.50929,-121.51015,-121.51464,-121.51187,-121.50885,-121.50828,-121.50554,-121.50248,-121.4948,-121.49316,-121.49432,-121.4944],"lat":[34.05235,34.05364,34.05501,34.05755,34.0574,34.06805,34.07793,34.08307,34.08865,34.09499,34.10291,34.10472,34.1107,34.12059,34.1266,34.13329,34.13492,34.14119,34.147,34.15394,34.16516,34.17199,34.18474,34.20368,34.21841,34.22762,34.23305,34.24069,34.26109,34.28462,34.29826,34.32091,34.32679,34.33346,34.34042,34.34186,34.34725,34.35168,34.3584,34.37216,34.38108,34.39419,34.42265,34.42877,34.43341,34.44324,34.44729,34.45227,34.46353,34.46891,34.48026,34.48729,34.49333,34.50352,34.51513,34.52154,34.53411,34.55216,34.55654,34.55898,34.56617,34.57212,34.5743,34.58046,34.58534,34.58907,34.60174,34.61349,34.62664,34.63277,34.63509,34.64108,34.65253,34.66091,34.66686,34.67216,34.67644,34.68803,34.69939,34.71572,34.72817,34.73912,34.75244,34.76391,34.77116,34.77814,34.7919,34.79699,34.79926,34.80903,34.81268,34.81607,34.8313,34.83699,34.83965,34.85632,34.87084,34.87947,34.88476,34.8906,34.89631,34.89983,34.91285,34.92156,34.92584,34.93033,34.94116,34.96365,35.00677,35.01285,35.01816,35.0321,35.07328,35.11599,35.24801,35.29054,35.3088,35.3501,35.42053,35.49589,35.53634,35.56273,35.60332,35.61674,35.65226,35.68529,35.78532,35.83359,35.87021,35.97952,36.00409,36.01937,36.03817,36.06586,36.07837,36.10122,36.17637,36.2518,36.29709,36.30973,36.35219,36.46914,36.5048,36.52871,36.55379,36.62395,36.67316,36.72886,36.85654,36.89149,36.91226,36.94045,36.95907,36.97122,36.98217,36.99959,37.01651,37.05833,37.08417,37.11595,37.14577,37.19939,37.30426,37.35257,37.38718,37.40275,37.42552,37.44344,37.45264,37.46859,37.4845,37.50324,37.53031,37.58047,37.59432,37.59931,37.64011,37.68854,37.75116,37.75693,37.7603,37.77027,37.78946,37.80765,37.83236,37.87028,37.88578,37.93163,37.94582,37.94927,37.95557,37.95753,37.96069,37.96892,37.98657,38.03611,38.08002,38.10075,38.11193,38.12026,38.12529,38.14178,38.16093,38.18364,38.20425,38.23971,38.2463,38.27207,38.3271,38.38519,38.42607,38.46662,38.47158,38.47842,38.49191,38.50021,38.50785,38.5126,38.52707,38.53415,38.53863,38.54322,38.54951,38.56185,38.56733,38.57151,38.57542,38.5797,38.58276,38.58066,38.58101,38.58176,38.58157]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[34.05235,38.58276],"lng":[-121.52206,-118.24181]}},"evals":[],"jsHooks":[]}</script>
<p>There is only two general steps in order to make it with R. The first is getting the geospatial data. The second is to map it.</p>
<div id="getting-the-data" class="section level2">
<h2>Getting the Data</h2>
<p>Depending on your individual use case, you can find a lot of open source geospatial data online that will outline certain regions on a map such as state, county, or city boundaries. They are sometimes referred to as shapefiles and are basically polygons placed on a plane with a specific coordinate system. In my experience, I found that I didn’t need to worry much about understanding the different coordinating systems as I was learning how to make maps. Usually, the data would have this information integrated in your file or R would understand where your spatial objects need to be placed. However, I wouldn’t recommend forgetting about trying to learn about coordinate systems and expecting R to handle the data without errors.</p>
<p>In our case above we need specific lines (not a polygon outlining a certain region) to highlight the trip between Los Angeles and Sacramento. This is where <strong>ggmap</strong> is a valuable package. The <strong>ggmap</strong> package can use APIs from Google’s map services (Find an introduction to understanding what APIs are <a href="https://zapier.com/learn/apis/">here</a>.) However, in order to use <strong>ggmap</strong> you need to register with Google to get credentials to access their services. The <a href="https://github.com/dkahle/ggmap">ggmap</a> package discusses how to set this up. There are various useful API’s you can use, such as <em>Geocoding API</em> (converting addresses into longitude and latitude coordinates to place them on a map). What we used was the <em>Directions API</em>. The corresponding function provided by the <strong>ggmap</strong> function is <em>trek()</em></p>
<pre class="r"><code>#ggmap returns a dataset with the route
dat &lt;- trek(from = &quot;Los Angeles, California&quot;, to = &quot;Sacramento, California&quot;, structure = &quot;route&quot;)</code></pre>
<p>What <em>treck()</em> does is find all times on the road that you have to change directions to get from one place to another. Imagine if you are driving and all the times your GPS gives you directions to turn right or left. It then returns these locations into coordinate points in a dataset with 3 columns: lat, lon, route. Below are a few rows of the dataset returned.</p>
<table>
<thead>
<tr class="header">
<th align="right">lat</th>
<th align="right">lon</th>
<th align="left">route</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">34.05235</td>
<td align="right">-118.2436</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="right">34.05364</td>
<td align="right">-118.2455</td>
<td align="left">A</td>
</tr>
<tr class="odd">
<td align="right">34.05501</td>
<td align="right">-118.2443</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="right">34.05755</td>
<td align="right">-118.2418</td>
<td align="left">A</td>
</tr>
<tr class="odd">
<td align="right">34.05740</td>
<td align="right">-118.2427</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="right">34.06805</td>
<td align="right">-118.2563</td>
<td align="left">A</td>
</tr>
</tbody>
</table>
<p>All we are looking for are the latitude and longitude coordinates. We will use these columns with <strong>leaflet</strong> to make our map. Leaflet will essential plot all the points and simply connect them. The result will be multiple small lines that will outline a route on a map similar to when you find directions on your phone.</p>
</div>
</div>
<div id="plotting-your-map" class="section level1">
<h1>Plotting your map</h1>
<pre class="r"><code>library(leaflet)
leaflet() %&gt;% #initiates a leaflet html widget
  addTiles() %&gt;% #adds your base map 
  addPolylines(lng = dat$lon, lat = dat$lat) #connects all the lat and lon points in a line</code></pre>
</div>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="/2019/04/02/tidytuesday/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="/2019/04/02/tidytuesday/">First #TidyTuesday</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="/2019/04/23/tidy-tuesday/">Tidy Tuesday - MyAnimeList</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="/2019/04/23/tidy-tuesday/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'wcarcamo';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

</div>
</div>
<script src="/js/ui.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'Your Google Analytics tracking ID', 'auto');
    ga('send', 'pageview');
  }
</script>





</body>
</html>

